{% extends "main.html" %}
{% block content %}
{% include "header.html" %}

<main id="index">
  <div class="container">
    <div class="jumbotron mainBackDark text-light" style="margin-top: 40px;">
      <h1 class="fourEM">Available Schemas</h1>
      <form>
        <div class="form-row align-items-center">
          <div class="col-auto my-1">
            <label class="mr-sm-2 sr-only" for="inlineFormCustomSelect">Preference</label>
            <select @change='handleChange' class="custom-select mr-sm-2" id="inlineFormCustomSelect">
              <option selected>Choose...</option>
              <option v-for="item in availableClasses" :value="item" v-text="item"></option>
            </select>
          </div>
        </div>
      </form>
    </div>
  </div>
</main>
<script type="text/javascript">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.4.2/vue.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
<script>
var app = new Vue({
      el: '#index',
			data: function(){
				return {
          availableClasses:[],
          graph:[]
				}
			},
      methods:{
        reqFile: function(){
          axios.get('/static/misc/schema.jsonld').then(res=>{
            this.graph = res.data['@graph']
            this.getAvailableClasses()
          }).catch(err=>{
            throw err;
          })
      },
      getAvailableClasses(){
        let results = [];
        for (var i = 0; i < this.graph.length; i++) {
          if (this.graph[i].hasOwnProperty('@type') && this.graph[i]['@type'] === "rdfs:Class") {
            results.push(this.graph[i]["rdfs:label"]);
          }
        }
        this.availableClasses = results.sort();
      },
      handleChange: function(e){
        window.location.href = "/viewer/"+e.target.value;
      }
    },
    mounted:function(){
      this.reqFile()
    },
    created: function(){
      this.getAvailableClasses()
    }
  })
</script>
{% include "footer.html" %}
{% endblock %}
